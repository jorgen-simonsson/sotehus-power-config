services:
  sotehus-backend:
    image: ghcr.io/jorgen-simonsson/sotehus-backend:latest
    container_name: sotehus-backend
    restart: unless-stopped
    pull_policy: always

    ports:
      - "8080:8080"
    environment:
      # Server Configuration
      - SERVER_PORT=8080
      
      # MQTT Configuration
      - MQTT_BROKER_HOST=${MQTT_BROKER_HOST}
      - MQTT_BROKER_PORT=${MQTT_BROKER_PORT:-1883}
      - MQTT_USERNAME=${MQTT_USERNAME:-}
      - MQTT_PASSWORD=${MQTT_PASSWORD:-}
      - MQTT_TOPIC=${MQTT_TOPIC}
      
      # InfluxDB Configuration
      - INFLUXDB2_HOST=${INFLUXDB2_HOST}
      - INFLUXDB2_PORT=${INFLUXDB2_PORT:-8086}
      - INFLUXDB2_USER=${INFLUXDB2_USER:-}
      - INFLUXDB2_PASSWORD=${INFLUXDB2_PASSWORD:-}
      - INFLUXDB2_ORG=${INFLUXDB2_ORG}
      - INFLUXDB2_BUCKET=${INFLUXDB2_BUCKET}
      - INFLUXDB2_TOKEN=${INFLUXDB2_TOKEN}
      
      # SolarEdge Configuration
      - SOLAREDGE_API_KEY=${SOLAREDGE_API_KEY}
      - SOLAREDGE_SITE_ID=${SOLAREDGE_SITE_ID}
      
      # Spot Price Configuration
      - SPOTPRICE_REGION=${SPOTPRICE_REGION:-SE4}
      
      # Timezone
      - TZ=Europe/Stockholm
    env_file:
      - .env
    network_mode: host

